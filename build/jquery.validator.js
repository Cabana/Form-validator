(function(){Array.prototype.clean=function(f){var a;for(a=0;a<this.length;)this[a]===f&&(this.splice(a,1),a--),a++;return this};String.prototype.wrapInBraces=function(){return this.replace(/^/,"{").replace(/$/,"}")};String.prototype.replaceSquareBracketsWithBraces=function(){return this.replace(/\[/g,"{").replace(/\]/g,"}")};String.prototype.removeWhitespace=function(){return this.replace(/\s+/g,"")};this.Parser=function(){function f(a){this.defaults=a}f.prototype.parse=function(a){var b;b={};if(""===
a)return b;a=this._prepareString(a);return this._toJSON(a)};f.prototype.addDefaultValue=function(a,b){this.defaults||(this.defaults={});return this.defaults[a]=b};f.prototype._prepareString=function(a){a=a.removeWhitespace();this.defaults&&(a=this._applyOptionValues(a));a=this._setUndefinedValues(a);return a=this._wrapWordsInQuotes(a)};f.prototype._applyOptionValues=function(a){var b,c,e=this;b="";c=this._splitIntoWords(a);c.forEach(function(d,a){var g;g=c[a+1];e.defaults[d]&&":"!==g&&(d+=":"+e.defaults[d]);
return b+=d});return b};f.prototype._setUndefinedValues=function(a){var b,c;c=this._splitIntoWords(a);c.forEach(function(e,d){var a,b;a=c[d+1];b=c[d-1];if(/\]+/.test(a)&&":"!==b||","===a||void 0===a&&!/\]+/.test(e))return c[d]+=":undefined"});a=c.join("");b="";a.split(/(\[|,|\])/).forEach(function(c){/.*:.*:.*/.test(c)&&(c=c.replace(":undefined",""));return b+=c});return b};f.prototype._splitIntoWords=function(a){a.split(/(\w+)/).clean("");return a.split(/(:\[?|\]+,?|,)/).clean("")};f.prototype._wrapWordsInQuotes=
function(a){var b;b=this._splitIntoWords(a);b.forEach(function(c,e){if(!(":"===c||/\]+/.test(c)||":["===c||","===c))return/^\d+$/.test(c)?b[e]=parseInt(c):"true"===c?b[e]=!0:"false"===c?b[e]=!1:b[e]='"'+c+'"'});return b.join("")};f.prototype._toJSON=function(a){/\.*:\.*/.test(a)||(a+=':"undefined"');a=a.replaceSquareBracketsWithBraces().wrapInBraces();a=a.replace(/\\/g,"\\\\");return JSON.parse(a)};return f}()}).call(this);(function(){var f,a=[].indexOf||function(a){for(var c=0,e=this.length;c<e;c++)if(c in this&&this[c]===a)return c;return-1};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};f=function(a){switch(a.length){case 0:a="";break;case 1:a=a[0];break;case 2:a=a[0]+" and "+a[1];break;default:a=a.slice(0,-1).join(", ")+", and "+a[a.length-1]}return a};this.FormValidator=function(){function b(){var c,e,a,b,g;e={};g=Object.keys(this._validations);a=0;for(b=g.length;a<b;a++)c=
g[a],e[c]=this._validations[c].regex;c=new Parser(e);c.addDefaultValue("required",!0);c.addDefaultValue("allowEmpty",!0);this.parser=c}b.prototype.validateInput=function(c){var e,d,b;this._errorMessages=[];b=c.value;e=this._generateValidations(c.dataset.validation);d=[];e.format&&d.push(this._validateFormat(b,e.format));e.length&&d.push(this._validateLength(b,e.length));e.wordCount&&d.push(this._validateWordCount(b,e.wordCount));e.required&&""===b&&(this._errorMessages.push(this._validations.required.errorMessage),
d.push(!1));e.allowEmpty&&""===b&&(this._errorMessages=[],d=[!0]);e.dependsOn&&(e=document.getElementById(e.dependsOn).checked,e||(this._errorMessages=[],d=[!0]));this._setErrorMessage(c,this._errorMessages);return 0<=a.call(d,!1)?!1:!0};b.prototype.defineCustomValidation=function(c,a,d){null==d&&(d=this._validations.customValidations.defaultErrorMessage);this._validations[c]={};this._validations[c].regex=a;this._validations[c].errorMessage=d;return this.parser.addDefaultValue(c,a)};b.prototype.validateForm=
function(c){var e,d,b,g;e=[];g=c.querySelectorAll("[data-validation]");d=0;for(b=g.length;d<b;d++)c=g[d],e.push(this.validateInput(c));return 0<=a.call(e,!1)?!1:!0};b.prototype._validations={email:{regex:".+@.+\\..+",errorMessage:"Email is invalid"},tel:{regex:"\\d{8}",errorMessage:"Telephone number is invalid"},number:{regex:"^\\d+$",errorMessage:"Not a number"},length:{errorMessage:function(c,a){if(a&&c)return"Value most be at least "+c+" and maximum "+a+" characters long";if(c)return"Value most be at least "+
c;if(a)return"Value can't be longer than "+a}},wordCount:{errorMessage:function(c,a){if(a&&c)return"Can't contain less than "+c+" or more than "+a+" words";if(c)return"Can't contain less than "+c+" words";if(a)return"Can't contain more than "+a+" words"}},required:{errorMessage:"Can't be blank"},customValidations:{defaultErrorMessage:"Field is invalid"}};b.prototype._errorMessages=[];b.prototype._setErrorMessage=function(a,e){var d;this._resetErrorMessage(a);a.dataset.errorMessage&&(e=[a.dataset.errorMessage]);
d=f(e).toLowerCase().capitalize();return""===d?a.removeAttribute("data-error-message"):a.setAttribute("data-error-message",d)};b.prototype._resetErrorMessage=function(a){return a.setAttribute("data-error-message","")};b.prototype._generateValidations=function(a){return this.parser.parse(a)};b.prototype._validateFormat=function(c,e){var d,b=this;null==e&&(e={});d=[];Object.keys(e).forEach(function(a){var k;(k=RegExp(e[a]).test(c))||b._errorMessages.push(b._validations[a].errorMessage);return d.push(k)});
return 0<=a.call(d,!1)?!1:!0};b.prototype._validateLength=function(a,e){var d,b,g;null==e&&(e={});d=e.max;b=e.min;(g=this._isLengthWithinRange(a.length,b,d))||this._errorMessages.push(this._validations.length.errorMessage(b,d));return g};b.prototype._validateWordCount=function(a,e){var d,b,g;null==e&&(e={});b=e.max;g=e.min;d=""===a?d=0:a.split(/[ ]+/).length;d=this._isLengthWithinRange(d,g,b);""===a&&!b&&(d=!1);d||this._errorMessages.push(this._validations.wordCount.errorMessage(g,b));return d};b.prototype._isLengthWithinRange=
function(c,b,d){var f,g;d&&b?f=0<=a.call(function(){g=[];for(var a=b;b<=d?a<=d:a>=d;b<=d?a++:a--)g.push(a);return g}.apply(this),c):b?f=c>=b:d&&(f=c<=d);return f};return b}()}).call(this);(function(f,a,b,c){function e(a,b){this.element=a;this.options=f.extend({},h,b);this._defaults=h;this._name=d;this.init()}var d="validate",h={validator:new FormValidator,onBlur:!1,selectorClasses:{field:".field"},errorClasses:{input:"input-with-error",field:"field-with-error",form:"form-with-error"}};e.prototype={init:function(){var a=this,b=a.element,c=a.options,d=c.validator;b.setAttribute("novalidate","true");f(b).on("submit",function(e){d.validateForm(b)||e.preventDefault();a.setErrorClasses(b,
c);a.setErrorMessages(b,c)});if(c.onBlur)f(b).find("[data-validation]").on("blur",function(e){d.validateInput(this);a.setErrorClasses(b,c);a.setErrorMessages(b,c)})},setErrorClasses:function(a,b){f("."+b.errorClasses.input).removeClass(b.errorClasses.input);f("."+b.errorClasses.field).removeClass(b.errorClasses.field);f("."+b.errorClasses.form).removeClass(b.errorClasses.form);f(a).find("[data-error-message]").each(function(){var c=f(this),d=c.parents(b.selectorClasses.field),e=f(a);c.addClass(b.errorClasses.input);
d.addClass(b.errorClasses.field);e.addClass(b.errorClasses.form)})},setErrorMessages:function(a,b){f(a).find("small.error-message").remove();f(a).find("[data-error-message]").each(function(){var a=this.dataset.errorMessage;f(this).after('<small class="error-message">'+a+"</small>")})}};f.fn[d]=function(a){return this.each(function(){f.data(this,"plugin_"+d)||f.data(this,"plugin_"+d,new e(this,a))})}})(jQuery,window,document);
